apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: oauth-pages
  namespace: default
  annotations:
    external-dns.alpha.kubernetes.io/cloudflare-proxied: "false"
spec:
  parentRefs:
    - name: envoy-oauth
      namespace: network
    - name: envoy-oauth-internal
      namespace: network
  hostnames:
    - oauth.${SECRET_DOMAIN}
    - oauth-internal.${SECRET_DOMAIN}
  rules:
    - matches:
        - path:
            type: Exact
            value: /denied
      backendRefs:
        - name: oauth-pages
          port: 80
    - matches:
        - path:
            type: Exact
            value: /logged-out
      backendRefs:
        - name: oauth-pages
          port: 80
