# Template: App Opt-In to OAuth Gateway
# Shows how an app's HTTPRoute switches from public to OAuth-protected.
# Only the parentRefs name changes â€” no other modifications required.
# Replace: <APP_NAME>, <APP_NAMESPACE>, <HOSTNAME>, <SERVICE_NAME>
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: <APP_NAME>
  namespace: <APP_NAMESPACE>
spec:
  parentRefs:
    # Change from envoy-external / envoy-internal to an OAuth Gateway:
    - name: envoy-oauth-external
      namespace: network
  hostnames:
    - <HOSTNAME>
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: <SERVICE_NAME>
          port: 80
